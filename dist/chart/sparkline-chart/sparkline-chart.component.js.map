{"version":3,"sources":["../../../build/src/app/chart/sparkline-chart/sparkline-chart.component.ts"],"names":[],"mappings":"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","file":"sparkline-chart.component.js","sourceRoot":"","sourcesContent":["import {\n  Component,\n  DoCheck,\n  Input,\n  OnInit,\n  ViewEncapsulation\n} from '@angular/core';\n\nimport { cloneDeep, defaultsDeep, isEqual, merge, uniqueId } from 'lodash';\n\nimport { ChartBase } from '../chart-base';\nimport { ChartDefaults } from '../chart-defaults';\nimport { SparklineChartConfig } from './sparkline-chart-config';\nimport { SparklineChartData } from './sparkline-chart-data';\n\n/**\n * Sparkline chart component\n *\n * Note: In order to use charts, please include the following JavaScript file from PatternFly.\n * <code><pre>\n * require('patternfly/dist/js/patternfly-settings');\n * </pre></code>\n *\n * Usage:\n * <code><pre>\n * // Individual module import\n * import { SparklineChartModule } from 'patternfly-ng/chart';\n * // Or\n * import { SparklineChartModule } from 'patternfly-ng';\n *\n * &#64;NgModule({\n *   imports: [SparklineChartModule,...]\n * })\n * export class AppModule(){}\n * </pre></code>\n *\n * Optional:\n * <code><pre>\n * import { SparklineChartConfig, SparklineChartData } from 'patternfly-ng/chart';\n * </pre></code>\n */\n\nexport class SparklineChartComponent extends ChartBase implements DoCheck, OnInit {\n  /**\n   * Chart data\n   */\n   chartData: SparklineChartData;\n\n  /**\n   * Configuration object containing details about how to render the chart\n   */\n   config: SparklineChartConfig;\n\n  private defaultConfig: SparklineChartConfig;\n  private prevChartData: SparklineChartData;\n  private prevConfig: SparklineChartConfig;\n\n  /**\n   * Default constructor\n   * @param chartDefaults\n   */\n  constructor(protected chartDefaults: ChartDefaults) {\n    super();\n  }\n\n  /**\n   * Setup component configuration upon initialization\n   */\n  ngOnInit(): void {\n    this.setupConfigDefaults();\n    this.setupConfig();\n    this.generateChart(this.config, true);\n  }\n\n  /**\n   * Check if the component config has changed\n   */\n  ngDoCheck(): void {\n    const dataChanged = !isEqual(this.chartData, this.prevChartData);\n    if (dataChanged || !isEqual(this.config, this.prevConfig)) {\n      this.setupConfig();\n      this.generateChart(this.config, !dataChanged);\n    }\n  }\n\n  /**\n   * Set up default config\n   */\n  protected setupConfig(): void {\n    if (this.config !== undefined) {\n      defaultsDeep(this.config, this.defaultConfig);\n    } else {\n      this.config = cloneDeep(this.defaultConfig);\n    }\n\n    /*\n     * Setup Axis options. Default is to not show either axis. This can be overridden in two ways:\n     *   1) in the config, setting showAxis to true will show both axes\n     *   2) in the attributes showXAxis and showYAxis will override the config if set\n     *\n     * By default only line and the tick marks are shown, no labels. This is a sparkline and should be used\n     * only to show a brief idea of trending. This can be overridden by setting the config.axis options per C3\n     */\n    if (this.config.axis !== undefined) {\n      this.config.axis.x.show = this.config.showXAxis === true;\n      this.config.axis.y.show = this.config.showYAxis === true;\n    }\n    if (this.config.chartHeight !== undefined) {\n      this.config.size.height = this.config.chartHeight;\n    }\n    this.config.data = merge(this.config.data, this.getChartData());\n    this.prevConfig = cloneDeep(this.config);\n    this.prevChartData = cloneDeep(this.chartData);\n  }\n\n  /**\n   * Set up config defaults\n   */\n  protected setupConfigDefaults(): void {\n    this.defaultConfig = this.chartDefaults.getDefaultSparklineConfig();\n\n    this.defaultConfig.axis = {\n      x: {\n        show: this.config.showXAxis === true,\n        type: 'timeseries',\n        tick: {\n          format: () => {\n            return ''; // change to lambda ?\n          }\n        }\n      },\n      y: {\n        show: this.config.showYAxis === true,\n        tick: {\n          format: () => {\n            return ''; // change to lambda ?\n          }\n        }\n      }\n    };\n    this.defaultConfig.chartId = uniqueId(this.config.chartId);\n    this.defaultConfig.data = { type: 'area' };\n    this.defaultConfig.tooltip = this.tooltip();\n    this.defaultConfig.units = '';\n  }\n\n  // Chart\n\n  /**\n   * Convert chartData to C3 data property\n   */\n  protected getChartData(): any {\n    let data: any = {};\n\n    if (this.chartData && this.chartData.dataAvailable !== false && this.chartData.xData && this.chartData.yData) {\n      data.x = this.chartData.xData[0];\n      data.columns = [\n        this.chartData.xData,\n        this.chartData.yData\n      ];\n    }\n    return data;\n  }\n\n  /**\n   * Tooltip function for sparklines\n   *\n   * @returns {{contents: ((d:any)=>string), position: ((data:any, width:number,\n   *            height:number, element:any)=>{top: number, left: number})}}\n   */\n  tooltip(): any {\n    return {\n      contents: (d: any) => {\n        let tipRows;\n        let percentUsed = 0;\n\n        switch (this.config.tooltipType) {\n          case 'usagePerDay':\n            if (this.chartData.dataAvailable !== false && this.chartData.total > 0) {\n              percentUsed = Math.round(d[0].value / this.chartData.total * 100.0);\n            }\n            tipRows =\n              '<tr>' +\n              '  <th colspan=\"2\">' + d[0].x.toLocaleDateString() + '</th>' +\n              '</tr>' +\n              '<tr>' +\n              '  <td class=\"name\">' + percentUsed + '%:' + '</td>' +\n              '  <td class=\"value text-nowrap\">' + d[0].value + ' '\n              + (this.config.units ? this.config.units + ' ' : '') + d[0].name + '</td>' +\n              '</tr>';\n            break;\n          case 'valuePerDay':\n            tipRows =\n              '<tr>' +\n              '  <td class=\"value\">' + d[0].x.toLocaleDateString() + '</td>' +\n              '  <td class=\"value text-nowrap\">' + d[0].value + ' ' + d[0].name + '</td>' +\n              '</tr>';\n            break;\n          case 'percentage':\n            percentUsed = Math.round(d[0].value / this.chartData.total * 100.0);\n            tipRows =\n              '<tr>' +\n              '  <td class=\"name\">' + percentUsed + '%' + '</td>' +\n              '</tr>';\n            break;\n          default:\n            tipRows = this.chartDefaults.getDefaultSparklineTooltip().contents(d);\n        }\n        return this.getTooltipTableHTML(tipRows);\n      },\n      position: (data: any, width: number, height: number, element: any) => {\n        let center;\n        let top;\n        let chartBox;\n        let graphOffsetX;\n        let x;\n\n        try {\n          center = parseInt(element.getAttribute('x'), 10);\n          top = parseInt(element.getAttribute('y'), 10);\n          chartBox = document.querySelector('#' + this.config.chartId).getBoundingClientRect();\n          graphOffsetX = document.querySelector('#' + this.config.chartId + ' g.c3-axis-y')\n            .getBoundingClientRect().right;\n          x = Math.max(0, center + graphOffsetX - chartBox.left - Math.floor(width / 2));\n\n          return {\n            top: top - height,\n            left: Math.min(x, chartBox.width - width)\n          };\n        } catch (e) {\n        }\n      }\n    };\n  }\n\n  // Private\n\n  private getTooltipTableHTML(tipRows: any): string {\n    return '<div class=\"module-triangle-bottom\">' +\n      '  <table class=\"c3-tooltip\">' +\n      '    <tbody>' +\n      tipRows +\n      '    </tbody>' +\n      '  </table>' +\n      '</div>';\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\n  encapsulation: ViewEncapsulation.None,\n  selector: 'pfng-sparkline-chart',\n  template: `<div #chartElement id=\"{{config.chartId}}\"></div>`\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ChartDefaults, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'chartData': [{ type: Input },],\n'config': [{ type: Input },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}